#!/bin/bash

# Step 1: Run 'make clock'
make clock

# Check if 'make clock' was successful
if [ $? -eq 0 ]; then
  # Step 2: Check if the '--deploy' parameter was used
  if [ "$1" == "--deploy" ]; then
    # Step 3: Copy all .uf2 files to /media/rupirie/RPI-RP2
    cp ~/Documents/ClockPCB/Env-OpenClock/Firmware/build/*.uf2 /media/rupirie/RPI-RP2
    # Check if the copy was successful
    if [ $? -eq 0 ]; then
      echo -e "\033[0;32mDeployment successful!"
    else
      echo -e "\033[0;31mDeployment failed, are you sure the pico is connected in firmware mode?"
    fi
  else
    echo -e "\033[0;32mProject compiled successfully, but not deployed. If you wish to deploy, connect pico in debug mode and use parameter '--deploy'."
  fi
else
  echo -e "\033[0;31mProject failed to compile. Deployment skipped."
fi
